<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Federal Income Tax Share by Taxpayer Percentiles (2022)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        canvas#taxChart {
            max-width: 600px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <h1>Federal Income Tax Share by Taxpayer Percentiles (2022)</h1>
    <canvas id="taxChart"></canvas>

    <!-- Load Chart.js with integrity hash for security -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js" integrity="sha256-MD3W0W4gqErqdy8izwXAN7La3v2aV0qOKnM1G2L4TDA=" crossorigin="anonymous"></script>
    <script>
        // Check if Chart.js loaded successfully
        if (typeof Chart === 'undefined') {
            console.error('Chart.js failed to load. Please check the CDN or network connection.');
            alert('Error: Chart.js could not be loaded. Please try refreshing the page or check your network.');
        } else {
            const ctx = document.getElementById('taxChart').getContext('2d');
            
            // Check if canvas context is available
            if (!ctx) {
                console.error('Canvas element not found or context unavailable.');
                alert('Error: Unable to render chart. Canvas element not found.');
                return;
            }

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Top 1%', 'Top 5%', 'Top 10%', 'Top 25%', 'Top 50%', 'Bottom 50%'],
                    datasets: [{
                        label: 'Share of Federal Income Tax Paid (%)',
                        data: [40.4, 59.1, 70.5, 85.6, 97, 3],
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(153, 102, 255, 0.2)',
                            'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Percentage of Total Federal Income Tax'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Taxpayer Percentile'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        title: {
                            display: true,
                            text: 'Federal Income Tax Share by Taxpayer Percentiles (2022)'
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
